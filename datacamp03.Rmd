---
title: "Introduction to the Tidyverse"
output: 
 html_document:
   toc: true
   toc_depth: 2
   number_sections: true
   toc_float: true
---

```{css, include=FALSE}
.badCode {
background-color: red;
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Data wrangling

```{r}
library(gapminder)
library(dplyr)
```

## The filter verb

```{r}
gapminder %>%
  filter(year == 2007)
gapminder %>%
  filter(country == "Brazil")
gapminder %>%
  filter(year == 2007, country == "Brazil")
```

## The arrange verb

```{r}
gapminder %>%
  arrange(gdpPercap)
gapminder %>%
  arrange(desc(gdpPercap))
gapminder %>%
  arrange(-gdpPercap)
gapminder %>%
  filter(year==2007) %>%
  arrange(desc(gdpPercap))
```

## The mutate verb

```{r}
gapminder %>%
  mutate(pop = pop/1000000)
gapminder %>%
  mutate(gdp = pop*gdpPercap)
gapminder %>%
  mutate(gdp = gdpPercap*pop)%>%
  filter(year==2007)%>%
  arrange(desc(gdp))
```

# Data visualization


```{r}
library(ggplot2)
gapminder_2007 <- gapminder %>%
  filter(year==2007)
```

```{r}
ggplot(data = gapminder_2007, mapping = aes(x = gdpPercap, y = lifeExp)) +
  geom_point()
```

## Log scales

```{r}
ggplot(data = gapminder_2007, mapping = aes(x = log(gdpPercap), y = lifeExp)) +
  geom_point()
ggplot(data = gapminder_2007, mapping = aes(x = gdpPercap, y = lifeExp)) +
  geom_point() + 
  scale_x_log10()
```

## Additional aesthetics

```{r}
ggplot(gapminder_2007, aes(x=gdpPercap,y=lifeExp,color=continent,size = pop)) + 
  geom_point() +
  scale_x_log10()
```

## Faceting

```{r}
ggplot(gapminder_2007, aes(x=gdpPercap,y=lifeExp)) + 
  geom_point() +
  scale_x_log10()+
  facet_wrap(~continent) #splitting BY continent
```

# Grouping and summarizing

## The summarize verb

```{r}
gapminder%>%
  summarise(meanLifeExp = mean(lifeExp))
gapminder%>%
  filter(year==2007)%>%
  summarise(meanLifeExp = mean(lifeExp), totalPop = sum(pop))
```

## The group_by verb

```{r}
gapminder%>%
  group_by(year)%>%
  summarise(meanLifeExp = mean(lifeExp), totalPop = sum(pop))

gapminder%>%
  filter(year==2007)%>%
  group_by(continent)%>%
  summarise(meanLifeExp = mean(lifeExp), totalPop = sum(pop))

gapminder%>%
  group_by(year,continent)%>%
  summarise(meanLifeExp = mean(lifeExp), totalPop = sum(pop))
```

## Visualizing summarized data

```{r}
by_year<-gapminder%>%
  group_by(year)%>%
  summarize(meanLifeExp = mean(lifeExp), totalPop = sum(pop))

by_year

ggplot(by_year,aes(x=year,y=totalPop))+
  geom_point()

ggplot(by_year,aes(x=year,y=totalPop))+
  geom_point() +
  expand_limits(y=0)
```

```{r}
by_year_continent <- gapminder %>%
  group_by(year,continent)%>%
  summarize(meanLifeExp = mean(lifeExp), totalPop = sum(pop))

by_year_continent

ggplot(by_year_continent,aes(x=year,y=totalPop,color=continent))+
  geom_point()+
  expand_limits(y=0)
```

# Types of visualizations

## Line plots

```{r}
ggplot(by_year_continent,aes(x=year,y=totalPop,color=continent))+
  geom_line()+
  expand_limits(y=0)
```

## Bar plots

Bar plots are useful for comparing values across discrete categories, such as continents.

```{r}
by_continent <- gapminder %>%
  filter(year==2007)%>%
  group_by(continent)%>%
  summarize(meanLifeExp = mean(lifeExp))

ggplot(by_continent,aes(x=continent,y=meanLifeExp))+
  geom_col()
```

## Histograms

```{r}
ggplot(gapminder_2007,aes(x=lifeExp)) + 
  geom_histogram(binwidth = 5)
```

Setting binwidth equals 5 means that each of the bars in the histograms represents a width of five years. 

## Boxplots

```{r}
ggplot(gapminder_2007,aes(x=continent,y=lifeExp))+
  geom_boxplot()
```


---
This code was last compiled at `r Sys.time()`